<ion-header>
  <ion-toolbar>
    <!-- Pop up title -->
    <ion-title>
      {{
        'page.program.program-people-affected.payment-history-popup.title'
          | translate
      }}
    </ion-title>
    <!-- Exit cancel button -->
    <ion-buttons slot="end">
      <ion-button
        (click)="closeModal()"
        [attr.title]="'common.cancel' | translate"
        [attr.aria-label]="'common.cancel' | translate"
      >
        <ion-icon
          name="close"
          slot="icon-only"
          aria-hidden="true"
        ></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- PA name -->
<ion-content class="ion-padding">
  <h2>{{ paDisplayName }}</h2>

  <!-- Accordion -->
  <ion-accordion-group [multiple]="true">
    <ion-accordion *ngFor="let paymentRow of paymentRows">
      <ion-item slot="header">
        <ion-grid class="ion-justify-content-start">
          <ion-row class="accordion-label">
            <!-- Money Icon -->
            <ion-col size="1">
              <ion-icon
                class="money-icon"
                name="cash-outline"
              ></ion-icon>
            </ion-col>

            <!-- Transfer index -->
            <ion-col>
              <ion-text class="transfer"
                >Transfer #{{ paymentRow.paymentIndex }}
              </ion-text>

              <!-- Transfer status -->
              <ng-container>
                <ion-chip
                  *ngIf="paymentRow.transaction?.status"
                  [ngClass]="
                    paymentRow.transaction?.status === 'success'
                      ? 'success'
                      : 'failed'
                  "
                >
                  <ion-label>
                    {{
                      'page.program.program-payout.last-payment.' +
                        paymentRow.transaction?.status | translate
                    }}
                  </ion-label>
                </ion-chip>
              </ng-container>

              <!-- Open voucher button -->
              <ng-container *ngIf="paymentRow.transaction">
                <ion-button
                  size="small"
                  fill="clear"
                  *ngIf="
                    hasVoucherSupport(paymentRow.fsp) && !hasError(paymentRow)
                  "
                  (click)="rowClick(paymentRow)"
                  [ngClass]="{
                    'open-voucher-button': true
                  }"
                >
                  Open voucher
                </ion-button>
              </ng-container>

              <!-- Send payment button -->
              <ng-container>
                <ion-button
                  class="send-payment-button"
                  shape="round"
                  fill="outline"
                  size="small"
                  *ngIf="hasError(paymentRow)"
                  (click)="rowClick(paymentRow)"
                >
                  Send payment
                </ion-button>
              </ng-container>

              <!---- Single payment -->
              <ng-container *ngIf="enableSinglePayment(paymentRow)">
                <button
                  type="button"
                  (click)="rowClick(paymentRow)"
                  [ngClass]="{
                    'is-error': hasError(paymentRow),
                    'ion-no-padding popup-button': true
                  }"
                >
                  {{
                    'page.program.program-people-affected.transaction.do-single-payment'
                      | translate
                  }}
                  <br />
                  <ion-icon
                    name="add-circle-outline"
                    size="small"
                    aria-hidden="true"
                  ></ion-icon>
                </button>
              </ng-container>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="1"></ion-col>
            <ion-col>
              <ion-text class="date">
                {{
                  paymentRow.text.split(',')[0].split('-').reverse().join('-')
                }}
              </ion-text>
            </ion-col>
          </ion-row>
        </ion-grid>
        <ion-icon
          name="chevron-down-outline"
          class="ion-accordion-toggle-icon"
          size="small"
        >
        </ion-icon>
      </ion-item>

      <!-- Accordion content -->
      <div slot="content">
        <ion-grid>
          <ion-row>
            <ion-col size="6">
              <ion-list>
                <ion-item>
                  <ion-label class="accordion-text">Sent: </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right"
                    >-</ion-label
                  >
                </ion-item>
                <ion-item>
                  <ion-label class="accordion-text"
                    >Financial Officer:
                  </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right"
                    >-</ion-label
                  >
                </ion-item>
                <ion-item>
                  <ion-label class="accordion-text">Amount: </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right">{{
                    paymentRow.amount
                  }}</ion-label>
                </ion-item>
              </ion-list>
            </ion-col>

            <ion-col size="6">
              <ion-list>
                <ion-item>
                  <ion-label class="accordion-text">Received: </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right"
                    >-</ion-label
                  >
                </ion-item>
                <ion-item>
                  <ion-label class="accordion-text">FSP: </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right">{{
                    paymentRow.transaction?.fspName
                  }}</ion-label>
                </ion-item>
                <ion-item>
                  <ion-label class="accordion-text">Used: </ion-label>
                  <ion-label class="accordion-text text-bold ion-text-right"
                    >-</ion-label
                  >
                </ion-item>
              </ion-list>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </ion-accordion>
  </ion-accordion-group>
</ion-content>
